<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>stoikheia's website Blog</title>
        <link>https://stoikheia.github.io/blog</link>
        <description>stoikheia's website Blog</description>
        <lastBuildDate>Wed, 08 Jun 2022 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[パフォーマンスモニタリング]]></title>
            <link>https://stoikheia.github.io/blog/diary</link>
            <guid>diary</guid>
            <pubDate>Wed, 08 Jun 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[パフォーマンスモニタリング]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="パフォーマンスモニタリング">パフォーマンスモニタリング<a class="hash-link" href="#パフォーマンスモニタリング" title="Direct link to heading">​</a></h2><p>ISUCON本批判のツイートからすこし調べた。</p><p>topコマンドは実際の使用率を表さないというもの。
以下のリンクを参考に貼ってあった。</p><p><a href="https://yakst.com/ja/posts/4575" target="_blank" rel="noopener noreferrer">CPU使用率は間違っている</a></p><ul><li>prefコマンドでストール率を見るといいらしい</li><li>tiptopがIPCを出力してくれるのでtopの代わりに使うとよい。</li></ul><p>記事にはそもそもストール率を考慮しないというのは無いのでは？という記事の前提としているレベルの低さに対する指摘もあった。</p><p>私見としてはただちにtopが不要という考えになるものではないと思った。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tiptopをインストールしてみる">tiptopをインストールしてみる<a class="hash-link" href="#tiptopをインストールしてみる" title="Direct link to heading">​</a></h3><p>環境：ubuntu</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -y tiptop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>インストールは成功したが実行しようとすると</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> tiptop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">syscall: Operation not permitted</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Could not perform syscall.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Don't know why</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>WSL上ではできない？</p><p><a href="https://www.creationline.com/lab/46861" target="_blank" rel="noopener noreferrer">Dockerが採用するセキュリティ機構「Seccomp」とは何か？ </a></p><p>seccompが原因か？</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> system info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Security Options:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  seccomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Profile: default</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>少し触って気づいたが、
現在の環境のWSL2はDocker上ではなく逆にDockerがWSL2上にあるのでこの設定ではない。</p><p><strong>解決せず。</strong></p>]]></content:encoded>
            <category>tech</category>
        </item>
    </channel>
</rss>